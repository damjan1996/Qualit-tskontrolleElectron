# RFID QR Wareneingang - Electron Version

üöÄ **Moderne Desktop-Anwendung** f√ºr RFID-basierte Zeiterfassung und QR-Code Wareneingang

Schlanke aber vollst√§ndige Electron-Implementierung der bew√§hrten Python-L√∂sung mit modernder Web-UI und nativer Desktop-Integration.

## ‚ú® Features

### üè∑Ô∏è RFID-Integration
- **Automatische Tag-Erkennung** √ºber HID-kompatible RFID-Reader
- **Intelligente Filterung** verhindert Fehlscans und Duplikate
- **Ein-/Ausloggen** durch erneutes Scannen des gleichen Tags
- **Multi-User Support** - mehrere Benutzer k√∂nnen gleichzeitig arbeiten

### üì∏ QR-Code Scanner
- **Browser-basiert** mit WebRTC und getUserMedia API
- **Live-Video-Preview** mit Scan-Overlay und Zielhilfen
- **Automatische Erkennung** mit jsQR Library
- **Flexible Zuordnung** - Last Login, Round-Robin oder manuell

### üíæ Direkte SQL Server Integration
- **Connection Pooling** f√ºr optimale Performance
- **Automatische Reconnection** bei Verbindungsfehlern
- **Transaction Support** f√ºr Datenkonsistenz
- **Health Checks** und Diagnose-Tools

### üé® Moderne Desktop-UI
- **Responsive Design** mit CSS Grid und Flexbox
- **Dark/Light Theme** automatisch basierend auf System-Einstellungen
- **Live-Updates** aller Benutzer-Sessions und Scan-Aktivit√§ten
- **Notification System** f√ºr Status-Feedback
- **Native Window Controls** (Minimize, Close)

## üõ†Ô∏è Technologie-Stack

| Komponente | Technologie | Zweck |
|------------|-------------|--------|
| **Desktop Framework** | Electron 27+ | Native Desktop App mit Web-Technologien |
| **Backend** | Node.js 16+ | Server-seitige Logik und Hardware-Integration |
| **Frontend** | Vanilla JS + HTML5 | Moderne Web-UI ohne Framework-Overhead |
| **Styling** | CSS3 + Custom Properties | Responsives Design mit Theme-Support |
| **Datenbank** | Microsoft SQL Server | Direkte Integration mit mssql Package |
| **RFID** | node-hid | HID-Ger√§t Integration f√ºr RFID-Reader |
| **QR-Scanner** | jsQR + WebRTC | Browser-basierte QR-Code Erkennung |
| **IPC** | Electron IPC + contextBridge | Sichere Main ‚Üî Renderer Kommunikation |

## üì¶ Installation

### Voraussetzungen

**Software:**
- Node.js 16.0 oder h√∂her
- Microsoft ODBC Driver 18 for SQL Server
- Windows 10/11 (empfohlen) oder macOS/Linux

**Hardware:**
- USB RFID-Reader (HID-Modus)
- Webcam f√ºr QR-Code Scanning
- Netzwerk-Zugriff auf SQL Server

### 1. Projekt Setup

```bash
# Repository klonen oder Dateien entpacken
cd C:\Users\damja\WebstormProjects\Shirtful\Wareneingang\rfid-qr-app

# Dependencies installieren
npm install

# Electron spezifische Tools
npm install --save-dev electron electron-builder
```

### 2. Konfiguration

```bash
# Umgebungs-Konfiguration kopieren
copy .env.example .env

# .env bearbeiten und anpassen:
# - MSSQL_SERVER, MSSQL_USER, MSSQL_PASSWORD
# - QR_DEFAULT_ASSIGNMENT_MODE
# - UI-Einstellungen
```

**Beispiel .env:**
```env
MSSQL_SERVER=116.202.224.248
MSSQL_DATABASE=RdScanner
MSSQL_USER=sa
MSSQL_PASSWORD=YourSecretPassword

QR_DEFAULT_ASSIGNMENT_MODE=last_login
RFID_MIN_SCAN_INTERVAL=1000
UI_WINDOW_WIDTH=1200
UI_WINDOW_HEIGHT=800
```

### 3. Datenbank Setup

Stellen Sie sicher, dass die SQL Server Datenbank mit den erforderlichen Tabellen existiert:

- `ScannBenutzer` - Benutzer mit RFID-Tags
- `Sessions` - Aktive und historische Arbeitssessions
- `QrScans` - Erfasste QR-Code Daten

### 4. RFID-Reader Setup

Ihr RFID-Reader muss als **HID-Tastatur** konfiguriert sein:

1. Reader an USB anschlie√üen
2. Als Tastatur-Device erkennen lassen
3. Test in Texteditor - Tags sollten als Text + Enter ausgegeben werden
4. Keine zus√§tzlichen Treiber erforderlich

## üöÄ Anwendung starten

### Development Mode
```bash
npm run dev
# oder
npm start
```

### Production Mode
```bash
npm run build
npm start
```

### Portable Executable erstellen
```bash
npm run build-win
# Ausgabe in dist/ Ordner
```

## üì± Bedienung

### üîë Benutzer-Anmeldung
1. **RFID-Tag scannen** ‚Üí Benutzer wird automatisch angemeldet
2. **Session-Timer startet** und wird live in der UI angezeigt
3. **Mehrere Benutzer** k√∂nnen gleichzeitig angemeldet sein
4. **Erneuter Tag-Scan** ‚Üí Benutzer wird abgemeldet

### üì∏ QR-Code Erfassung
1. **"Scanner starten"** klicken ‚Üí Kamera-Zugriff erlauben
2. **QR-Code vor Kamera halten** ‚Üí Automatische Erkennung
3. **Zuordnung** erfolgt je nach Modus:
    - **Last Login**: An zuletzt angemeldeten Benutzer
    - **Round-Robin**: Automatisch reihum an alle Benutzer
    - **Manual**: Dialog zur manuellen Benutzer-Auswahl

### üë• Multi-User Workflow
```
Benutzer A: RFID scannen ‚Üí Anmelden ‚Üí QR-Codes werden automatisch zugeordnet
Benutzer B: RFID scannen ‚Üí Anmelden ‚Üí Round-Robin Verteilung aktiv
Benutzer C: RFID scannen ‚Üí Anmelden ‚Üí Jeder QR-Code geht an n√§chsten Benutzer
```

## ‚öôÔ∏è Konfiguration

### QR-Zuordnungsmodi

| Modus | Beschreibung | Ideal f√ºr |
|-------|--------------|-----------|
| `last_login` | Alle QR-Codes an zuletzt angemeldeten Benutzer | Einzelarbeitsplatz |
| `round_robin` | Automatische Verteilung reihum | Teamarbeit mit gleichm√§√üiger Verteilung |
| `manual` | Dialog-Auswahl bei jedem QR-Code | Spezifische Zuordnungen erforderlich |

### Wichtige Einstellungen

```env
# Performance Tuning
RFID_MIN_SCAN_INTERVAL=1000      # Mindestabstand RFID-Scans (ms)
QR_GLOBAL_COOLDOWN=300           # QR-Duplikat Verhinderung (s)
UI_UPDATE_INTERVAL=1000          # UI-Refresh Rate (ms)

# Multi-User Optimierung  
QR_CROSS_USER_CHECK=true         # Duplikat-Check zwischen Benutzern
QR_SESSION_COOLDOWN=3600         # Session-spezifisches Cooldown (s)

# UI-Anpassung
UI_THEME=default                 # default, dark, light
UI_SHOW_DEBUG=false              # Debug-Informationen anzeigen
```

### Datenbank-Optimierung

```env
# Connection Pool
MSSQL_POOL_MAX=10               # Maximum Verbindungen
MSSQL_POOL_MIN=0                # Minimum Verbindungen
MSSQL_POOL_IDLE_TIMEOUT=30000   # Idle Timeout (ms)

# Timeouts
MSSQL_REQUEST_TIMEOUT=30000     # Query Timeout (ms)
MSSQL_CONNECTION_TIMEOUT=15000  # Verbindungs-Timeout (ms)
```

## üîß Troubleshooting

### RFID-Reader Probleme

‚ùå **Reader wird nicht erkannt**
```bash
# Pr√ºfen Sie:
1. USB-Verbindung
2. HID-Modus aktiviert
3. Windows erkennt als Tastatur-Device
4. Test in Notepad - Tags sollten sichtbar sein
```

‚úÖ **L√∂sung:**
- RFID-Reader auf HID-Keyboard-Modus umstellen
- `RFID_MIN_SCAN_INTERVAL` reduzieren (500ms)
- Reader-Dokumentation f√ºr Konfiguration pr√ºfen

### Kamera-Probleme

‚ùå **QR-Scanner startet nicht**
```bash
# H√§ufige Ursachen:
1. Kamera-Berechtigung verweigert
2. Kamera von anderer App verwendet
3. Browser-Sicherheitsrichtlinien
```

‚úÖ **L√∂sung:**
- Kamera-Berechtigung in Browser/System erlauben
- Andere Apps schlie√üen die Kamera verwenden
- HTTPS verwenden (f√ºr getUserMedia erforderlich in Production)

### Datenbank-Verbindung

‚ùå **Connection failed**
```bash
# Pr√ºfen Sie:
1. Server erreichbar: ping 116.202.224.248
2. Port offen: telnet 116.202.224.248 1433  
3. Firewall-Einstellungen
4. SQL Server Authentication aktiviert
```

‚úÖ **L√∂sung:**
```env
# Versuchen Sie:
MSSQL_TRUST_CERT=true
MSSQL_ENCRYPT=false
MSSQL_CONNECTION_TIMEOUT=30000
```

### Performance-Probleme

‚ùå **Langsame UI oder hohe CPU-Last**

‚úÖ **Optimierung:**
```env
UI_UPDATE_INTERVAL=2000          # Weniger h√§ufige Updates
QR_GLOBAL_COOLDOWN=600          # L√§ngeres Cooldown
MSSQL_POOL_MAX=5                # Kleinerer Connection Pool
APP_DEBUG=false                 # Debug-Modus deaktivieren
```

## üìä Monitoring & Logs

### Built-in Monitoring

Die Anwendung bietet Live-Monitoring √ºber die UI:

- **System Status** - Datenbank und RFID-Verbindung
- **Aktive Benutzer** - Live-Timer und Scan-Counts
- **Scanner Status** - Kamera-Zustand und letzte Aktivit√§t
- **Recent Scans** - Letzte 20 QR-Codes mit Benutzer-Zuordnung

### Logs

```
logs/
‚îú‚îÄ‚îÄ main.log              # Hauptanwendung
‚îú‚îÄ‚îÄ database.log          # SQL Server Operationen  
‚îú‚îÄ‚îÄ rfid.log              # RFID-Events
‚îî‚îÄ‚îÄ renderer.log          # Frontend-Events
```

### Health Check API

Interne Diagnose-Funktionen √ºber IPC:

```javascript
// Verf√ºgbar in Renderer Process
await window.electronAPI.db.healthCheck();
// Returns: { connected, connectionTime, serverInfo, stats }
```

## üîÑ Updates & Deployment

### Development Updates
```bash
# Dependencies aktualisieren
npm update

# Electron Version updaten
npm install electron@latest --save-dev

# Security Audit
npm audit fix
```

### Production Deployment

```bash
# Optimized Build
npm run build-win

# Installer erstellen
# Ausgabe: dist/RFID QR Wareneingang Setup.exe

# Silent Installation
"RFID QR Wareneingang Setup.exe" /S

# Update bestehende Installation
# Installer √ºberschreibt automatisch
```

### Auto-Update (Optional)

F√ºr automatische Updates kann electron-updater integriert werden:

```bash
npm install electron-updater --save
```

## üîí Sicherheit

### Datenbank-Sicherheit
- ‚úÖ Prepared Statements gegen SQL Injection
- ‚úÖ Connection Pooling mit Timeouts
- ‚úÖ Verschl√ºsselte Verbindungen (TLS/SSL)
- ‚úÖ Minimale Benutzerrechte in SQL Server

### Anwendungs-Sicherheit
- ‚úÖ Content Security Policy (CSP)
- ‚úÖ Context Isolation f√ºr Renderer Process
- ‚úÖ Keine Node.js Integration im Frontend
- ‚úÖ Secure IPC mit contextBridge

### Empfohlene H√§rtung

```env
# Production Security
NODE_ENV=production
APP_DEBUG=false
MSSQL_ENCRYPT=true
MSSQL_TRUST_CERT=false
```

## üìÑ Lizenz & Support

**Propriet√§r** - Nur f√ºr den internen Gebrauch bei Shirtful

**Support:**
1. **System-Test**: Integrierte Diagnose in der Anwendung
2. **Logs pr√ºfen**: `logs/` Verzeichnis f√ºr detaillierte Fehleranalyse
3. **Health Check**: Database ‚Üí Health Check im Men√º
4. **Hardware-Test**: RFID und Kamera √ºber UI testen

---

## üÜö Python vs. Electron Comparison

| Feature | Python Version | **Electron Version** |
|---------|----------------|---------------------|
| **Startup Zeit** | ~3-5 Sekunden | ~1-2 Sekunden |
| **Memory Usage** | ~50-80 MB | ~80-120 MB |
| **UI Framework** | Tkinter | Modern Web UI |
| **Cross-Platform** | Windows/Linux | Windows/macOS/Linux |
| **Updates** | Manual | Auto-Update ready |
| **Development** | Python + Tkinter | JavaScript + HTML/CSS |
| **Distribution** | .exe + Python Runtime | Single .exe |
| **Performance** | Native | V8 Engine |

**Electron Vorteile:**
- ‚úÖ Modernere, ansprechendere UI
- ‚úÖ Einfachere Anpassung und Styling
- ‚úÖ Cross-Platform ohne √Ñnderungen
- ‚úÖ Bessere Developer Experience
- ‚úÖ Auto-Update Infrastruktur

**Python Vorteile:**
- ‚úÖ Geringerer Memory-Footprint
- ‚úÖ Direkte Hardware-Integration
- ‚úÖ Bew√§hrte Stabilit√§t
- ‚úÖ Keine Browser-Dependencies

---

üéâ **Die Electron-Version kombiniert die bew√§hrte Funktionalit√§t der Python-L√∂sung mit einer modernen, benutzerfreundlichen Desktop-Oberfl√§che!**